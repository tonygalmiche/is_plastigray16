<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- is.gestion.lot -->
        <record id="view_is_gestion_lot_form" model="ir.ui.view">
            <field name="name">is.gestion.lot.form</field>
            <field name="model">is.gestion.lot</field>
            <field name="arch" type="xml">
                <form>
                    <group>
                        <group>
                            <field name="operation" readonly="1" />
                            <field name="product_id"  />
                            <field name="is_uc_qt"  />
                            <field name="prod_lot_id" />
                            <field name="product_qty" />
                        </group>
                        <group>
                            <field name="location_src_id"         widget="selection" />
                            <field 
                                name="location_dest_bloq_id"   
                                widget="selection"
                                domain="[
                                    ('control_quality','=',True), 
                                    ('usage','=','internal')
                                ]" 
                                attrs="{'invisible':[('operation','!=','bloque')], 'required':[('operation','=','bloque')]}"
                            /> 
                            <field 
                                name="location_dest_debloq_id" 
                                widget="selection"
                                domain="[
                                    ('control_quality','=',False), 
                                    ('usage','=','internal')
                                ]" 
                                attrs="{'invisible':[('operation','!=','debloque')], 'required':[('operation','=','debloque')]}"
                            />
                            <field 
                                name="location_dest_change_id" 
                                widget="selection"
                                domain="[
                                    ('usage','=','internal')
                                ]" 
                                attrs="{'invisible':[('operation','!=','change_location')], 'required':[('operation','=','change_location')]}"
                            /> 
                            <field 
                                name="location_dest_rebut_id" 
                                widget="selection"
                                domain="[
                                    ('usage','!=','view'),
                                    ('scrap_location','=',True)
                                ]" 
                                attrs="{'invisible':[('operation','!=','rebut')], 'required':[('operation','=','rebut')]}"
                            /> 
                        </group>
                    </group>
                    <group>
                        <field name="description" placeholder="Description ..."/>
                    </group>
                    <footer>
                        <button name="validate_lot" string="Valider" type="object" default_focus="1" class="btn-primary"/>
                        <button string="Annuler" class="btn-secondary" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>
        <!-- <record id="action_is_gestion_lot" model="ir.actions.act_window">
            <field name="name">Gestion de lot</field>
            <field name="res_model">is.gestion.lot</field>
            <field name="view_mode">tree,form</field>
           <field name="view_id" ref="view_is_gestion_lot_form"/>
           <field name="target">new</field>
        </record> -->
                




        <!-- is.gestion.lot.report -->
        <record id="is_gestion_lot_report_tree_view" model="ir.ui.view">
            <field name="name">is_gestion_lot_report_tree_view</field>
            <field name="model">is.gestion.lot.report</field>
            <field name="arch" type="xml">
                <tree create="false">
                    <field name="product_id"  widget="many2one_clickable"/>
                    <field name="mold"/>
                    <field name="location_id" widget="many2one_clickable"/>
                    <field name="usage"           optional="hide"/>
                    <field name="control_quality" optional="hide"/>
                    <field name="lot_id"      widget="many2one_clickable"/>
                    <field name="in_date" />
                    <field name="qty" sum="Total" />
                    <field name="qty_par_uc" />
                    <field name="qty_uc" sum="Total"/>
                    <button 
                        title="Bloquer lot"
                        type="object"
                        name="bloquer_lot_action"
                        icon="fa-ban"
                    />
                    <button 
                        title="Mise au rebut"
                        type="object"
                        name="mise_au_rebut_action"
                        icon="fa-trash"
                        groups="is_plastigray16.is_rsp_production_group,is_plastigray16.is_qualite_group"
                    />
                    <!-- <field name="operation" invisible="1"/> -->
                    <!-- <button 
                        title="Bloquer lot"
                        type="action"
                        name="(action_is_gestion_lot)d"
                        icon="fa-ban"
                    />
                    <button 
                        title="Mise au rebut"
                        type="action"
                        name="(action_is_mise_rebut)d"
                        icon="fa-trash" 
                        groups="is_plastigray16.is_rsp_production_group,is_plastigray16.is_qualite_group"
                    /> -->
                </tree>
            </field>
        </record>
        <record id="is_gestion_lot_report_search_view" model="ir.ui.view">
            <field name="name">is_gestion_lot_report_search_view</field>
            <field name="model">is.gestion.lot.report</field>
            <field name="arch" type="xml">
                <search>
                    <field name="product_id" />
                    <field name="mold" />
                    <field name="lot_id" />
                    <field name="location_id" />
                    <field name="usage" />
                    <field name="control_quality" />
                </search>
            </field>
        </record>
        <record id="is_gestion_lot_report_action" model="ir.actions.act_window">
            <field name="name">Gestion des lots</field>
            <field name="res_model">is.gestion.lot.report</field>
            <field name="view_mode">tree</field>
            <!-- <field name="context">{'operation': 'bloque'}</field> -->
            <!-- <field name="search_view_id" ref="view_stock_lot_bloque_search" /> -->
        </record>

        <record id="is_gestion_lot_bloquer_action" model="ir.actions.act_window">
            <field name="name">Bloquer un lot</field>
            <field name="res_model">is.gestion.lot.report</field>
            <field name="view_mode">tree</field>
            <field name="domain">[
                ('usage'          , '=', 'internal'),
                ('control_quality', '=', False),
                ('qty'            , '>', 0.01),
            ]</field>
        </record>




        <!--  Mise au rebut -->
        <!-- <record id="view_is_stock_mise_rebut_wizard" model="ir.ui.view">
            <field name="name">Gestion de rebut</field>
            <field name="model">is.stock.mise.rebut</field>
            <field name="arch" type="xml">
                <form string="Gestion de rebut">
                    <group>
                        <field name="product_id" />
                        <field name="is_uc_qt"  />
                        <field name="product_qty"/>
                        <field name="prod_lot_id"  />
                        <field name="location_src_id" invisible="1" />
                        <field name="operation" invisible="1" />
                        <field 
                            name="location_rebut_id" 
                            widget="selection"
                            domain="[('usage','!=','view'),('scrap_location','=',True)]" 
                            attrs="{'invisible': [('operation','=','rebut')], 'required':[('operation','!=','rebut')]}"
                        />
                        <field 
                            name="location_revert_id" 
                            widget="selection"
                            domain="[('usage','=','internal')]" 
                            attrs="{'invisible': [('operation','!=','rebut')], 'required':[('operation','=','rebut')]}"
                        />
                    </group>
                    <footer>
                        <button name="validate_scrap" string="Valider" type="object" default_focus="1" class="btn-primary"/>
                        <button string="Annuler" class="btn-secondary" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>
        <record id="action_is_mise_rebut" model="ir.actions.act_window">
            <field name="name">Mettre au rebut</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">is.stock.mise.rebut</field>
            <field name="view_id" ref="view_is_stock_mise_rebut_wizard"/>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>
        <record id="action_is_reverse_mise_rebut" model="ir.actions.act_window">
            <field name="name">Remettre au stock</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">is.stock.mise.rebut</field>
            <field name="view_id" ref="view_is_stock_mise_rebut_wizard"/>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record> -->


        <!-- Bloquer lot -->
        <!-- <record id="view_stock_lot_bloque_tree" model="ir.ui.view">
            <field name="name">report.stock.lot.bloque.tree</field>
            <field name="model">report.stock.lot.bloque</field>
            <field name="arch" type="xml">
                <tree string="Bloquer lots" create="false">
                    <field name="product_id" widget="many2one_clickable"/>
                    <field name="mold"/>
                    <field name="location_id"/>
                    <field name="lot_id" widget="many2one_clickable"/>
                    <field name="in_date" />
                    <field name="qty" sum="Total" />
                    <field name="qty_par_uc" />
                    <field name="qty_uc" sum="Total"/>
                    <field name="operation" invisible="1"/>
                    <button 
                        title="Bloquer lot"
                        type="action"
                        name="%(action_is_gestion_lot)d"
                        icon="fa-ban"
                    />
                    <button 
                        title="Mise au rebut"
                        type="action"
                        name="%(action_is_mise_rebut)d"
                        icon="fa-trash" 
                        groups="is_plastigray16.is_rsp_production_group,is_plastigray16.is_qualite_group"
                    />
                </tree>
            </field>
        </record>
        <record id="view_stock_lot_bloque_search" model="ir.ui.view">
            <field name="name">report.stock.lot.bloque.search</field>
            <field name="model">report.stock.lot.bloque</field>
            <field name="arch" type="xml">
                <search string="Bloquer lot">
                    <field name="product_id" />
                    <field name="mold" />
                    <field name="lot_id" />
                    <field name="location_id" />
                </search>
            </field>
        </record>
        <record id="action_stock_lot_bloque_report" model="ir.actions.act_window">
            <field name="name">Bloquer lot</field>
            <field name="res_model">report.stock.lot.bloque</field>
            <field name="view_mode">tree</field>
            <field name="context">{'operation': 'bloque'}</field>
            <field name="search_view_id" ref="view_stock_lot_bloque_search" />
        </record> -->



        <!-- Debloquer lot -->
        <!-- <record id="view_stock_lot_debloque_tree" model="ir.ui.view">
            <field name="name">report.stock.lot.debloque.tree</field>
            <field name="model">report.stock.lot.debloque</field>
            <field name="arch" type="xml">
                <tree string="Déloquer lots" create="false">
                    <field name="product_id"/>
                    <field name="location_id"/>
                    <field name="mold"/>
                    <field name="lot_id" />
                    <field name="qty" sum="Total" />
                    <field name="qty_par_uc" />
                    <field name="qty_uc" sum="Total"/>
                    <field name="in_date" />
                    <field name="operation" invisible="1"/>
                    <button title="Débloquer lot"
                            type="action"
                            name="%(action_is_gestion_lot)d"
                            icon="fa-play" />
                    <button title="Mise au rebut"
                            type="action"
                            name="%(action_is_mise_rebut)d"
                            icon="fa-trash" />
            </tree>
            </field>
        </record>
        
        <record id="view_stock_lot_debloque_search" model="ir.ui.view">
            <field name="name">report.stock.lot.debloque.search</field>
            <field name="model">report.stock.lot.debloque</field>
            <field name="arch" type="xml">
                <search string="Débloquer lot">
                    <field name="product_id" />
                    <field name="mold" />
                    <field name="lot_id" />
                    <field name="location_id" />
                </search>
            </field>
        </record>
        <record id="action_stock_lot_debloque_report" model="ir.actions.act_window">
            <field name="name">Débloquer lot</field>
            <field name="res_model">report.stock.lot.debloque</field>
            <field name="view_mode">tree</field>
            <field name="context">{'operation': 'debloque'}</field>
            <field name="search_view_id" ref="view_stock_lot_debloque_search" />
        </record> -->

    </data>
</odoo>
